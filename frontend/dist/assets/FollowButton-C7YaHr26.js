import{u as q,d as Q,r as d,b as K,e as F,j as v,f as i}from"./index-Dm03hG7C.js";const p=({followerId:e,followingId:t})=>{const{currentUser:o}=q(),l=(o==null?void 0:o.role)==="guest",n=Q(),[u,a]=d.useState(!1),{data:s}=K({queryKey:["following",e],queryFn:()=>i.getFollowing(e),enabled:!!e}),r=(()=>{var w;return(((w=s==null?void 0:s.data)==null?void 0:w.data)||[]).some(b=>b.id===t)})(),c=F({mutationFn:()=>i.follow({followerId:e,followingId:t}),onSuccess:()=>{n.invalidateQueries({queryKey:["following",e]}),n.invalidateQueries({queryKey:["member-followers",t]}),n.invalidateQueries({queryKey:["member-following",e]}),a(!0)}}),y=F({mutationFn:()=>i.unfollow(e,t),onSuccess:()=>{n.invalidateQueries({queryKey:["following",e]}),n.invalidateQueries({queryKey:["member-followers",t]}),n.invalidateQueries({queryKey:["member-following",e]}),a(!1)}}),f=()=>{!o||l||(r||u?y.mutate():c.mutate())},g=c.isPending||y.isPending,m=r||u;return v.jsx("button",{className:`follow-btn ${m?"following":""}`,onClick:f,disabled:g||!o||l,children:g?"...":m?"Following":"Follow"})};export{p as F};
