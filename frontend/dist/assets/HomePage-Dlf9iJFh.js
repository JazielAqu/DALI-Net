import{u as D,a as P,r as w,b as F,j as a,g as y,c as M,m as E}from"./index-Dm03hG7C.js";import{F as T}from"./FollowButton-C7YaHr26.js";const B=()=>{var g;const{currentUser:c,setUser:n}=D(),i=P(),[d,I]=w.useState(""),[C,S]=w.useState({}),{data:o,isLoading:b,error:h}=F({queryKey:["members"],queryFn:()=>E.getAll({limit:250}),staleTime:5*60*1e3}),m=((g=o==null?void 0:o.data)==null?void 0:g.data)||[],l=d.trim().toLowerCase(),u=l?m.filter(e=>{var s,r;return((s=e.name)==null?void 0:s.toLowerCase().includes(l))||((r=e.bio)==null?void 0:r.toLowerCase().includes(l))}):m,A=e=>y([e.profileImage,e.picture,e.image],C,"/default-avatar.jpg"),L=e=>{const s=e.locked===!0,r=y([e.profileImage,e.picture,e.image],{},"/default-avatar.jpg");!c&&!s?(async()=>{var x,f,v,N;try{const t=await M.demoLogin(e.id),k=(f=(x=t==null?void 0:t.data)==null?void 0:x.data)==null?void 0:f.token,U=((N=(v=t==null?void 0:t.data)==null?void 0:v.data)==null?void 0:N.user)||e;k&&localStorage.setItem("authToken",k),n({...U,profileImage:r,image:r,picture:r})}catch(t){console.warn("Demo login failed, falling back to local persona only",t),n({...e,profileImage:r,image:r,picture:r})}finally{i(`/profile/${e.id}`)}})():i(`/profile/${e.id}`)},p=e=>{const s=[];return e.dev&&s.push("Dev"),e.des&&s.push("Design"),e.pm&&s.push("PM"),e.core&&s.push("Core"),e.mentor&&s.push("Mentor"),s};return a.jsxs("div",{className:"home-page",children:[a.jsxs("div",{className:"home-hero",children:[a.jsx("h1",{children:"Welcome to DALI Net"}),a.jsx("p",{children:"Connect with DALI lab members and share your projects!"})]}),a.jsxs("div",{className:"user-selection card",children:[a.jsx("h2",{children:"Select a User to Get Started"}),a.jsx("p",{className:"user-selection-hint",children:"Choose a member to view their profile and interact with the platform"}),a.jsx("div",{className:"search-box",children:a.jsx("input",{type:"text",className:"input",placeholder:"Search members...",value:d,onChange:e=>I(e.target.value)})}),b?a.jsx("div",{className:"spinner"}):h?a.jsxs("div",{className:"error-message",children:[a.jsxs("p",{children:["Error loading members: ",h.message]}),a.jsx("p",{children:"Make sure the backend server is running on http://localhost:3001"})]}):u.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("p",{children:"No members found."}),a.jsxs("p",{children:["Make sure you've run the seeder: ",a.jsx("code",{children:"cd backend && npm run seed"})]})]}):a.jsx("div",{className:"members-grid",children:u.map(e=>a.jsxs("div",{className:"member-card",onClick:()=>L(e),children:[a.jsx("img",{src:A(e),alt:e.name,className:"member-card-avatar",onError:s=>{s.target.onerror=null;const r=s.target.src;S(j=>({...j,[r]:!0})),s.target.src="/default-avatar.jpg"}}),a.jsxs("div",{className:"member-card-header",children:[a.jsx("h3",{className:"member-card-name",children:e.name}),e.role&&a.jsx("p",{className:"member-card-role",children:e.role})]}),p(e).length>0&&a.jsx("div",{className:"member-badges",children:p(e).map(s=>a.jsx("span",{className:"badge",children:s},s))}),c&&c.id!==e.id&&a.jsx("div",{className:"member-card-actions",onClick:s=>s.stopPropagation(),children:a.jsx(T,{followerId:c.id,followingId:e.id})})]},e.id))})]}),c&&a.jsxs("div",{className:"welcome-back card",children:[a.jsxs("h2",{children:["Welcome back, ",c.name,"!"]}),a.jsxs("div",{className:"welcome-actions",children:[a.jsx("button",{className:"btn btn-primary",onClick:()=>i("/feed"),children:"Go to Feed"}),a.jsx("button",{className:"btn btn-secondary",onClick:()=>i(`/profile/${c.id}`),children:"View Profile"})]})]})]})};export{B as default};
